# ------------------------------------------------------------------------------
# Copyright (C) 2016-2017 DELL EMC Corporation. All Rights Reserved.

# This software contains the intellectual property of DELL EMC Corporation
# or is licensed to DELL EMC Corporation from third parties.  Use of this
# software and the intellectual property contained therein is expressly
# limited to the terms and conditions of the License Agreement under which
# it is provided by or on behalf of DELL  EMC.

# ------------------------------------------------------------------------------

#-
#    include: plays/power-on-vms.yml
#    vars:
#        step: BKP - BPB-250-000
#        vms: sql_server

-
    include:  plays/backup-sql-db.yml
    vars:
        step: BKP - BPB-250-010
        dbName: '{{  databases.vro_database  }}'
        backupName: 'BPB-250-CONFIGURE-SQL.bak'
        vms: sql_server

-
    include: plays/backup-sql-db.yml
    vars:
        step: BKP - BPB-250-020
        dbName: '{{ databases.ehc_om_database }}'
        backupName: 'BPB-250-CONFIGURE-SQL.bak'
        vms: sql_server

-
    include: plays/power-off-vms.yml
    vars:
        step: BKP - BPB-250-030
        vms: sql_server

-
    include: plays/backup-snapshot.yml
    vars:
        step: BKP - BPB-250-040
        description: 'Configure SQL Server'
        snapshot_name: BPB-250-CONFIGURE-SQL
        snapshot_description: 'BPB-250-CONFIGURE-SQL'
        vms: sql_server
        dumpMemory: True
        powerOffVM: False

-
    include: plays/delete-snapshots-not-matching-name.yml
    vars:
        step: BKP - BPB-250-050
        vms: sql_servers
        inventoryPath: '/'
        snapshotName: BPB-250-CONFIGURE-SQL

-
    include: plays/power-on-vms.yml
    vars:
        step: BKP - BPB-250-060
        vms: sql_server

-
    include: plays/poll-sql-server.yml
    vars:
        step: BKP - BPB-250-070
        vms: sql_server

-
    include: plays/poll-sql-db.yml
    vars:
        step: BKP - BPB-250-080
        vms: sql_server
        dbName: '{{  databases.vro_database  }}'

-
    include: plays/poll-sql-db.yml
    vars:
        step: BKP - BPB-250-090
        vms: sql_server
        dbName: '{{  databases.ehc_om_database  }}'
