# ------------------------------------------------------------------------------
# Copyright (C) 2016-2017 DELL EMC Corporation. All Rights Reserved.

# This software contains the intellectual property of DELL EMC Corporation
# or is licensed to DELL EMC Corporation from third parties.  Use of this
# software and the intellectual property contained therein is expressly
# limited to the terms and conditions of the License Agreement under which
# it is provided by or on behalf of DELL  EMC.

# ------------------------------------------------------------------------------

-
    include: plays/power-off-vms.yml
    vars:
        step: BKP - BPB-700-010
        vms: vro_servers

-
    include: plays/backup-sql-db.yml
    vars:
        step: BKP - BPB-700-020
        dbName: '{{ databases.vro_database }}'
        backupName: 'BPB-700-Deploy-Configure-EHC-Foundation.bak'
        vms: sql_server

-
    include: plays/backup-sql-db.yml
    vars:
        step: BKP - BPB-700-030
        dbName: '{{ databases.ehc_om_database }}'
        backupName: 'BPB-700-Deploy-Configure-EHC-Foundation.bak'
        vms: sql_server

-
    include: plays/backup-snapshot.yml
    vars:
        step: BKP - BPB-700-040
        description: 'Deploy Configure EHC Foundation'
        snapshot_name: BPB-700-Deploy-Configure-EHC-Foundation
        snapshot_description: PB-700-Deploy-Configure-EHC-Foundation
        vms: vro_servers
        dumpMemory: True
        powerOffVM: False

-
    include: plays/delete-snapshots-not-matching-name.yml
    vars:
        step: BKP - BPB-700-050
        vms: vro_servers
        inventoryPath: '/'
        snapshotName:  BPB-700-Deploy-Configure-EHC-Foundation

-
    include: plays/delete-sql-db.yml
    vars:
        step: BKP - BPB-700-060
        dbName: '{{ databases.vro_database }}'
        backupName: 'BPB-700-Deploy-Configure-EHC-Foundation.bak'
        vms: sql_server

-
    include: plays/delete-sql-db.yml
    vars:
        step: BKP - BPB-700-070
        dbName: '{{ databases.ehc_om_database }}'
        backupName: 'BPB-700-Deploy-Configure-EHC-Foundation.bak'
        vms: sql_server

-
    include: plays/power-on-vms.yml
    vars:
        step: BKP - BPB-700-080
        vms: vro_primary

-
    include: plays/poll-vro.yml
    vars:
        step: BKP - BPB-700-090
        vms: vro_primary

-
    include: plays/power-on-vms.yml
    vars:
        step: BKP - BPB-700-100
        vms: vro_secondary

-
    include: plays/poll-vro.yml
    vars:
        step: BKP - BPB-700-110
        vms: vro_secondary

# Poll Clustered VRO
-
    include: plays/poll-vro-cluster.yml
    vars:
        step: BKP - BPB-400-120
        vms: vro_servers

# Poll EHC OM Compare
-
    include: plays/poll-vro-ehcom-compare.yml
    vars:
        step: BKP - BPB-400-130
        vms: vro_servers